
/*******************************************************************************************************************************//**
 	\file DR_7Seg_Expansion3.c
 	\brief Control acceso de veh√≠culos de un estacionamiento
 	\details Trabajo Practico Obligatorio
 	\author Marcos Trautman, Alan Kinast
 	\date 2016.11.25
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "DR_7Seg_Expansion3.h"

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/
extern volatile unsigned char Digitos[DIGITOS];			//!< Buffer de display
/***********************************************************************************************************************************
 *** VARIABLES GLOBLES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/**
	\fn  uint8_t Maquina_estados_sensores(void)
	\brief Driver de Barrido Display de 7 segmentos de la expansion 3
 	\details
 	\author Alan Kinast, Marcos Trautman
 	\date 2016.11.25
*/
void BarridoDisplay_Expansion3( void )
{
	unsigned char aux ;
	static int	digito = 0 ;

	SetPIN(EX3_BCDA,ON);
	SetPIN(EX3_BCDB,ON);
	SetPIN(EX3_BCDC,ON);
	SetPIN(EX3_BCDD,ON);
	SetPIN(EX3_dp,OFF);

	if( !digito )
	{
		SetPIN(EX3_MRS,ON);
		SetPIN(EX3_MRS,OFF);
	}
	else
	{
		SetPIN(EX3_CLOCK,ON);
		SetPIN(EX3_CLOCK,OFF);
	}
 	aux = Digitos[ digito ] ;

 	SetPIN(EX3_BCDA , aux & 0x01);
 	SetPIN(EX3_BCDB , ( aux >> 1 ) & 0x01);
 	SetPIN(EX3_BCDC , ( aux >> 2 ) & 0x01);
 	SetPIN(EX3_BCDD , ( aux >> 3 ) & 0x01);

	digito++ ;
	digito %= DIGITOS ;
}

